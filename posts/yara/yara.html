<!DOCTYPE html>
<html lang="en" mode="dark">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'UA-175469707-1');
    </script>
    <title>Introduction to yara rule | Mr Akuma</title>
    <meta name="generator" content="Jekyll v3.9.0" />
    <meta property="og:title" content="Bypassing malware detection" />
    <meta name="author" content="Mr Akuma" />
    <meta property="og:locale" content="en_US" />
    <meta name="description"
        content="The information provided in this site is for educational purposes regarding pentesting. The author of the site will not be held any responsibility for any misuse of the information from this site." />
    <meta property="og:description"
        content="The information provided in this site is for educational purposes regarding pentesting. The author of the site will not be held any responsibility for any misuse of the information from this site." />

    <link rel="icon" href="../../images/title.jpeg" />

    <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license -->
    <link rel="shortcut icon" href="../../img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="../../img/favicon.ico" type="image/x-icon">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="preconnect" href="cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="cdn.jsdelivr.net">
    <link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
        integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed -->
    <link rel="preload" as="style" href="../../css/post.css">
    <link rel="stylesheet" href="../../css/post.css">
	<link rel="stylesheet" href="../../css/code.css">
    <link rel="preload" as="style" href="../../css/bootstrap-toc.min.css">
    <link rel="stylesheet" href="../../css/bootstrap-toc.min.css" />
    <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        async></script>
    <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed -->
    <script src="../../js/post.min.js" async></script>
    <script src="../../js/app.js" defer></script>

<body data-spy="scroll" data-target="#toc">
    <div id="sidebar" class="d-flex flex-column">
        <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License -->
        <div id="nav-wrapper">
            <div id="profile-wrapper" class="d-flex flex-column">
                <div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img
                            src="../../images/title.jpeg" alt="avatar" onerror="this.style.display='none'">
                    </a></div>
                <div class="profile-text mt-3">
                    <div class="site-title"> <a href="/">Mr Akuma</a></div>
                    <div class="site-subtitle font-italic">Publish write-ups from various pentesting platforms</div>
                </div>
            </div>
            <ul class="nav flex-column">
                <li class="nav-item d-flex justify-content-center "> <a href="../../index.html"
                        class="nav-link d-flex justify-content-center align-items-center w-100"> <i
                            class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li>

                <li class="nav-item d-flex justify-content-center "> <a href="../../whoami.html"
                        class="nav-link d-flex justify-content-center align-items-center w-100"> <i
                            class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a></li>
            </ul>
        </div>
        <div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a
            href="https://github.com/akshay1729" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a
            href="https://twitter.com/Akshayjain890" target="_blank"> <i class="fab fa-twitter"></i> </a> <a
            href=" javascript:window.open('mailto:' + ['Akshayjain5','protonmail.com'].join('@'))"><i
               class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/akshay-jain-533a79111/"> <i
               class="fab fa-linkedin"></i> </a> <a href="https://www.hackthebox.eu/profile/189220"> <i
               class="fas fa-cube"></i> </a></div>

    </div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License -->
    <div id="topbar-wrapper" class="row justify-content-center topbar-down">
        <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb">
                <span> <a href="../../index.html"> Article </a> </span> <span>Jarvis Hack The Box</span> </span> <i id="sidebar-trigger"
                class="fas fa-bars fa-fw"></i>
            <div id="topbar-title"> Article</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span
                id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input
                    class="form-control" id="search-input" type="search" placeholder="Search..."> <i
                    class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span
                id="search-cancel">Cancel</span>
        </div>
    </div>
    <div id="main-wrapper">
        <div id="main">
            <div class="row">
                <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">
                    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
                        <h1 data-toc-skip>Hacking 101: Introduction to Yara rules</h1>
                        <div class="post-meta text-muted d-flex flex-column">
                            <div> Posted
                                <span class="timeago " data-toggle="tooltip" data-placement="bottom"
                                    title="Sun, Aug 4, 2019, 10:00 PM +0530"> Aug 4<i
                                        class="unloaded">2019-08-04T20:00:00+05:30</i> </span> by <span class="author">
                                    Mr Akuma </span></div>
                            <div> Updated
                                <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License -->
                                <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom"
                                    title="Sun, Aug 4, 2019, 10:00 PM +0530"> Sep 9 <i
                                        class="unloaded">2019-08-04T20:00:00+05:30</i> </span></div>
                        </div>
                        <div class="post-content"> <img src="cover.jpg">
                            <blockquote>
                                <p><strong>The information provided in this site is for educational purposes regarding
                                        pentesting. The author of the site will not be held any responsibility for any
                                        misuse of the information from this site.</strong></p>
                            </blockquote>
                            <h2 id="introduction"><strong><span style="color:#ff5555">Introduction</span></strong></h2>
                            <hr>
                            <p>You might have heard about YARA rules, it is an open-source tool for detecting and reversing hashes of arbitrary files and directories on an end system. And the thing about that is that the result of executing the rules via a regular command line is a perfectly nice file inclusion detector. It’s an extremely powerful tool</p>
                            <hr>
                            <p>YARA rules are a method for distinguishing malware (or files) by making decides that search for specific qualities. YARA was initially created by Victor Alvarez of Virustotal and is mostly utilized in malware research and location. It was created with the plan to depict designs that distinguish specific strains or whole groups of malware.</p>
                            <hr>
                            <p>YARA is a tool focused on causing malware researchers to recognize and characterize malware tests. With YARA you can make descriptions of malware families (or anything you desire to depict) in view of literary or parallel examples. Every portrayal, a.k.a rule, comprises of a lot of strings and a boolean articulation which decide its rationale. below is an example :</p>
                            <p>
<pre class="code_block">
rule test
{

    meta:
    description = "Example"
    threat_level = x
    strings:
        $a = {6A 40 68 00 30 00 00 6A 14 8D 91}
        $b = {8D 4D B0 2B C1 83 C0 27 99 6A 4E 59 F7 F9}
        $c = "PEJXQZAKCBGMTUVODFRYSIHLNW"
    condition:
        ($a or $b) and ($c or $d)
}
</pre>
                            </p>
                            <hr>
                            <p>YARA rules are easy to compose and comprehend, and they have a sentence structure that looks like the C language, below are keywords used in creating Yara rules</p>
                            <hr>
                            <p><img src="1.png"></img></p>
                            <h2 id="gen-syn"><strong><span style="color:#ff5555">General Syntax</span></strong></h2>
                            <hr>
                            <p>Rules are commonly made out of two things: strings definition and condition. The strings definition segment can be precluded if the standard doesn’t depend on any string, however, the conditioning segment is constantly required. The strings definition area is the place the strings that will be a piece of the standard are characterized. Each string has an identifier comprising in a $ character followed by an arrangement of alphanumeric characters and underscores, these identifiers can be utilized in the conditioning segment to allude to the comparing string. Strings can be characterized in content or hexadecimal structure, as appeared in the accompanying model:</p>
                            <hr>
                            <p>
<pre class="code_block">
rule Example_Rule
{
    strings:
        $my_text_string = "text"
        $my_hex_string = { E2 34 A1 C8 23 FB }
    condition:
        $my_text_string or $my_hex_string
}
</pre>
                            </p>
                            <hr>
                            <p>Each standard needs to begin with the word rule, trailed by the name or identifier. The identifier can contain any alphanumeric character and the underscore character, however, the primary character isn’t permitted to be a digit. There is a rundown of YARA watchwords that are not permitted to be utilized as an identifier since they have a predefined meaning.</p>
                            <h2 id="comments"><strong><span style="color:#ff5555">Comments</span></strong></h2>
                            <hr>
                            <p>YARA rules can be included with comments similar to c source code, single-line and multi-line comments can be used in Yara rules.</p>
                            <hr>
                            <p>
                                <pre class="code_block">
/*
    This is a multi-line comment.
*/
rule Example   // this is a single-line comment
{
    condition:
        True
}</pre>
                            </p>

                            <h2 id="strings"><strong><span style="color:#ff5555">Strings</span></strong></h2>
                            <hr>
                            <p>There are three types of strings in YARA: hexadecimal strings, text strings and regular expressions.</p>
                            <hr>
                            <p>Hexadecimal strings are used for defining raw sequences of bytes, while text strings and regular expressions are useful for defining portions of legible text. However, text strings and regular expressions can be also used for representing raw bytes by mean of escape sequences as will be shown below.</p>
                            <hr>
                            <p>To give the condition section meaning strings are utilized. The strings sections are where you can define the strings that will be looked for in the file. Let’s look at an easy example.</p>
                            <hr>
                            <p>
                                <pre class="code_block">
rule vendor
{
strings:
$text_string1 = “anything”
$text_string2 = “dummy”
condition:
$text_string1 or $text_string2
}</pre>
                            </p>
                            <h2 id="conditions"><strong><span style="color:#ff5555">Conditions</span></strong></h2>
                            <p>Conditions are just Boolean articulations as those that can be found in all programming dialects, for instance in an if explanation. They can contain the run of the mill Boolean administrators and, or and not and social administrators >=, <=, <, >, == and !=. Additionally, the number-crunching administrators (+, — , *, \, %) and bitwise administrators (and, |, <<, >>, ~, ^) can be utilized on numerical articulations.</p>
                            <hr>
                            <p>String identifiers can be likewise utilized inside a condition, going about as Boolean factors whose worth relies upon the nearness or not of the related string in the record</p>
                            <hr>
<p>
<pre class="code_block">
rule condition_Example
{
    strings:
        $a = "text1"
        $b = "text2"
        $c = "text3"
        $d = "text4"
    condition:
        ($a or $b) and ($c or $d)
}
</pre>
</p>
                            <h2 id="counterbalance"><strong><span style="color:#ff5555">String counterbalances</span></strong></h2>
                            <hr>
                            <p>In most of the cases, when a string identifier is utilized in a condition, we are eager to know whether the related string is anyplace inside the record or procedure memory, yet now and then we have to know whether the string is at some particular counterbalance on the document or at some virtual location inside the procedure address space. In such circumstances, the administrator at is the thing that we need. This administrator is utilized as appeared in the accompanying model:</p>
                            <p>
<pre class="code_block">
rule AtExample
{
    strings:
        $a = “dummy1”
        $b = “dummy2”
    condition:
       $a at 100 and $b at 200
}
</pre>
                            </p>
                            <hr>
                            <p>The articulation $a at 100 in the above model is genuine just if string $a is found at counterbalance 100 inside the record (or at virtual location 100 whenever applied to a running procedure). The string $b ought to show up at balance 200. If it’s not too much trouble note that the two counterbalances are decimal, anyway hexadecimal numbers can be composed by including the prefix 0x before the number as in the C language, which comes exceptionally convenient when composing virtual locations. Likewise, note the higher priority of the administrator at over the and.</p>
                            <hr>
                            <p>
<pre class="code_block">
rule example
{
    strings:
        $a = “dummy1”
        $b = “dummy2”
    condition:
        $a in (0..100) and $b in (100..filesize)
}
</pre>
                            </p>
                            <hr>
                            <p>In the model over the string $a must be found at a counterbalance somewhere in the range of 0 and 100, while string $b must be at a balanced among 100 and the finish of the document. Once more, numbers are decimal as a matter of course.</p>
                            <hr>
                            <p>You can likewise get the counterbalance or virtual location of the I-th event of string $a by utilizing @a[i]. The files are one-based, so the principal event would be @a[1] the second one @a[2], etc. In the event that you give a record more prominent, at that point the number of events of the string, the outcome will be a NaN (Not A Number) esteem.</p>
                            <h2 id="conclusion"><strong><span style="color:#ff5555">Conclusion</span></strong></h2>
                            <hr>
                            <p>To put it plainly, YARA is flexible, incredible and accessible. Its expectation to learn and adapt is delicate and its application is wide. In this present reality where your adversary covers up on display and around the bend, it has crazy identification ability to illuminate the suspicious, pernicious or plain simply intriguing. In the event that it hasn’t found a home in your toolbox, you ought to consistently request the best.</p>
                        </div>
                        <div class="post-tail-wrapper text-muted">
                            <div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a
                                    href='../../index.html'>Article</a></div>
                            <div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i>
                                <a class="post-tag no-text-decoration">Yara</a>
                                <a class="post-tag no-text-decoration">Security</a>
                                <a class="post-tag no-text-decoration">Malware Analysis</a>
                                </div>
                        </div>
                    </div>
                </div>
                <!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License -->
                <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">
                    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
                        <h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3>
                        <nav id="toc" data-toggle="toc"></nav>
                    </div>
                </div>
            </div>
            <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>
            <script type="text/javascript">
                const imgs = document.querySelectorAll('#post-wrapper img');
                const observer = lozad(imgs);
                observer.observe();
            </script>
            <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License -->
            <footer class="d-flex w-100 justify-content-center">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="footer-left">
                        <script src="https://www.hackthebox.eu/badge/189220"></script>
                </div>
            </footer>
        </div>
        <!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License -->
        <div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
            <div class="col-12 col-xl-11 post-content">
                <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
            </div>
        </div>
    </div>
    <div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i
            class="fas fa-angle-up"></i> </a>
    <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License -->
    <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License -->
    <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>
    <script>
        SimpleJekyllSearch({
            searchInput: document.getElementById('search-input'),
            resultsContainer: document.getElementById('search-results'),
            json: '/assets/js/data/search.json',
            searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="corshinecorshine.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>',
            noResultsText: '<p class="mt-5">Oops! No result founds.</p>'
        });
    </script>
